<!DOCTYPE html>
<html>
<head>
    <title>Visualizador Geoespacial</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
    <script src="https://unpkg.com/leaflet-geometryutil@latest/src/leaflet.geometryutil.js"></script>
    <script src="https://unpkg.com/leaflet-image@0.4.0/leaflet-image.js"></script> 

    <script src="https://unpkg.com/shpjs@latest/dist/shp.js"></script>
    <script src="https://unpkg.com/simple-statistics@7.8.3/dist/simple-statistics.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script> 
    
    <style>
        html, body, #map { height: 100%; width: 100%; margin: 0; padding: 0; background-color: #f0f0f0; }
        .leaflet-bar.custom-control { background-color: white; padding: 8px 12px; border: 2px solid rgba(0,0,0,0.2); border-radius: 4px; cursor: pointer; font: 14px "Helvetica Neue", Arial, Helvetica, sans-serif; box-shadow: 0 1px 5px rgba(0,0,0,0.65); }
        .info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; max-height: 45vh; overflow-y: auto; }
        .info h4 { margin: 0 0 5px; color: #777; cursor: pointer; user-select: none; }
        .info h4::after { content: ' ▼'; font-size: 10px; float: right; }
        .info.collapsed h4::after { content: ' ►'; }
        .info.collapsed { max-height: 40px; overflow: hidden; }
        .legend { text-align: left; line-height: 18px; color: #555; max-height: 300px; overflow-y: auto; }
        .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.9; }
        .info select, .info input { margin-bottom: 5px; width: 100%; box-sizing: border-box; }
        .info label { display: block; margin-top: 5px; font-weight: bold; color: #555; font-size: 12px; }
        .config-options { border-top: 1px solid #ddd; margin-top: 5px; padding-top: 5px; }
        .color-picker-container { display: flex; align-items: center; justify-content: space-between; }
        .color-picker-container input[type="color"] { width: 80px; height: 25px; padding: 0 2px; }
        .layer-list { list-style: none; padding: 0; margin: 0 0 10px 0; }
        .layer-list li { background-color: #fff; border: 1px solid #ddd; padding: 8px; margin-bottom: -1px; font-size: 13px; cursor: pointer; user-select: none; }
        .layer-list li:hover { background-color: #f4f4f4; }
        .layer-list li.active { font-weight: bold; background-color: #d4f2ff; border-left: 3px solid #0096d2; padding-left: 6px; }
        .layer-list li.sortable-ghost { background: #c8ebfb; }
        .hide-for-export { display: none !important; }
        .loading-indicator {
            position: absolute; 
            top: 10px; 
            right: 10px; 
            background: rgba(255,255,255,0.8); 
            padding: 5px 10px; 
            border-radius: 5px; 
            z-index: 1000;
            font-size: 14px;
            color: #333;
            box-shadow: 0 1px 5px rgba(0,0,0,0.65);
        }
    </style>
</head>
<body>

<div id="map"></div>

<script>
    const map = L.map('map', { attributionControl: false, preferCanvas: true }).setView([24.5, -99.5], 5); 
    const infoControl = L.control();
    const legendControl = L.control({position: 'bottomright'});
    let currentActiveLayer = null;
    let orderedLayers = [];
    let sortableInstance = null;
    
    let drawnItemsHistory = []; 

    const oceanBasemap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}', { attribution: 'Esri' });
    const streets = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: 'OpenStreetMap' });
    const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { attribution: 'Esri' });
    const light = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{y}/{x}{r}.png', { attribution: 'CARTO' });
    const baseMaps = { "Océano": oceanBasemap, "Calles": streets, "Satélite": satellite, "Claro": light };
    const layerControl = L.control.layers(baseMaps, {}, { collapsed: true }).addTo(map);
    oceanBasemap.addTo(map);
    L.control.attribution({ position: 'bottomleft', prefix: false }).addTo(map);
    
    const sequentialPalettes = { 'YlOrRd': ['#FFFFE5','#FFF7BC','#FEE391','#FEC44F','#FE9929','#EC7014','#CC4C02','#993404','#662506','#4C1B03'], 'Blues': ['#F7FBFF','#E3EEF9','#CFE1F2','#B5D4E9','#AC7E1','#7FB9D9','#64ABD1','#4BA0C9','#3294C1','#0884B9'], 'Greens': ['#F7F7F7','#E5F5E0','#C7E9C0','#A1D99B','#74C476','#41AB5D','#238B45','#006D2C','#00441B','#002B12'], 'Reds': ['#FFF5F0','#FEE0D2','#FCBBA1','#FC9272','#FB6A4A','#EF3B2C','#CB181D','#A50F15','#67000D','#4A0008'] };
    const categoricalPalettes = { 'Paired': ['#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928'], 'Accent': ['#7fc97f','#beaed4','#fdc086','#ffff99','#386cb0','#f0027f','#bf5b17','#666666'], 'Set1': ['#e41a1c','#377eb8','#4daf4a','#984ea3','#ff7f00','#ffff33','#a65628','#f781bf'] };

    // --- FUNCIONES Y CONTROLES ---
    function getColor(value, grades, paletteName) { if (value === undefined || value === null) return '#CCCCCC'; const palette = sequentialPalettes[paletteName]; for (let i = grades.length - 2; i >= 0; i--) { if (value > grades[i]) { return palette[i % palette.length]; } } if (value === grades[0]) return palette[0]; return '#CCCCCC'; }
    function updateVisualization(layer) { 
        if (!layer) return; 
        const config = layer.options.config; 
        
        const isPointLayer = layer.options.pointLayer;
        
        if (config.displayMode === 'simple') { 
            let simpleStyle = { weight: 2, color: config.simpleOutlineColor, fillColor: config.simpleFillColor }; 
            switch(config.simpleRenderMode) { 
                case 'both': simpleStyle.stroke = true; simpleStyle.fill = true; simpleStyle.fillOpacity = 0.6; break; 
                case 'fill': simpleStyle.stroke = false; simpleStyle.fill = true; simpleStyle.fillOpacity = 0.6; break; 
                case 'outline': simpleStyle.stroke = true; simpleStyle.fill = false; break; 
            } 
            
            if (isPointLayer) {
                layer.eachLayer(function(l) {
                    if (l instanceof L.CircleMarker) {
                        l.setStyle({ fillColor: config.simpleFillColor, color: config.simpleOutlineColor, fillOpacity: 0.8, radius: 8 });
                    }
                });
            } else {
                layer.setStyle(simpleStyle); 
            }
            if (layer === currentActiveLayer) legendControl.update(null); 
            return; 
        } 
        
        if (config.displayMode === 'classified') { 
            const values = layer.toGeoJSON().features.map(f => f.properties[config.activeVariable]).filter(v => v !== null && typeof v === 'number' && isFinite(v)); 
            const uniqueValues = [...new Set(values)]; 
            if (uniqueValues.length < 2) { 
                config.numericStats[config.activeVariable].grades = []; 
            } else { 
                const classCount = Math.min(uniqueValues.length, config.numClasses, sequentialPalettes[config.activePalette].length); 
                config.numericStats[config.activeVariable].grades = ss.jenks(values, classCount); 
            } 
        } 
        
        if (config.displayMode === 'categorical') { 
            const values = layer.toGeoJSON().features.map(f => f.properties[config.activeCategoricalVariable]); 
            const uniqueValues = [...new Set(values)].sort(); 
            config.categoricalMap = {}; 
            const palette = categoricalPalettes[config.activeCategoricalPalette]; 
            uniqueValues.forEach((value, index) => { config.categoricalMap[value] = palette[index % palette.length]; }); 
        } 
        
        const getDynamicStyle = function(feature) { 
            const currentConfig = this.options.config; 
            if (currentConfig.displayMode === 'classified') { 
                const value = feature.properties[currentConfig.activeVariable]; 
                const grades = currentConfig.numericStats[currentConfig.activeVariable].grades; 
                return { fillColor: getColor(value, grades, currentConfig.activePalette), weight: 1, opacity: 1, color: 'white', fillOpacity: 0.8 }; 
            } 
            if (currentConfig.displayMode === 'categorical') { 
                const value = feature.properties[currentConfig.activeCategoricalVariable]; 
                const color = currentConfig.categoricalMap[value] || '#CCCCCC'; 
                return { fillColor: color, weight: 1, opacity: 1, color: 'white', fillOpacity: 0.8 }; 
            } 
            return {};
        }.bind({options: {config: layer.options.config}});

        if (isPointLayer) {
             layer.eachLayer(function(l) {
                if (l instanceof L.CircleMarker) {
                    const style = getDynamicStyle(l.feature);
                    l.setStyle({ fillColor: style.fillColor, color: style.color, fillOpacity: style.fillOpacity, radius: 8 });
                }
            });
        } else {
            layer.setStyle(getDynamicStyle); 
        }
        
        if (layer === currentActiveLayer) { 
            legendControl.update(layer); 
        } 
    }

    function processData(geojson, name) { 
        const numericProperties = [], stringProperties = [], numericStats = {}; 
        let hasPoints = false;
        
        if (geojson.features && geojson.features.length > 0) { 
            const firstProps = geojson.features[0].properties; 
            for (const key in firstProps) { 
                if (typeof firstProps[key] === 'number') { 
                    numericProperties.push(key); 
                    numericStats[key] = {}; 
                } else if (typeof firstProps[key] === 'string') { 
                    stringProperties.push(key); 
                } 
            }
            hasPoints = geojson.features.some(f => f.geometry.type === 'Point' || f.geometry.type === 'MultiPoint');
        } 

        const defaultMode = numericProperties.length > 0 ? 'classified' : (stringProperties.length > 0 ? 'categorical' : 'simple'); 
        const layerConfig = { 
            name, 
            numericProperties, 
            stringProperties, 
            numericStats, 
            activeVariable: numericProperties[0] || null, 
            activeCategoricalVariable: stringProperties[0] || null, 
            numClasses: 7, 
            activePalette: 'YlOrRd', 
            activeCategoricalPalette: 'Paired', 
            displayMode: defaultMode, 
            simpleRenderMode: 'both', 
            simpleFillColor: '#3388ff',
            simpleOutlineColor: '#ffffff'
        }; 
        
        const geoJSONOptions = {
            config: layerConfig,
            style: function(feature) {
                return { color: "#3388ff", weight: 2, fillOpacity: 0.6 };
            },
            pointToLayer: function (feature, latlng) {
                return L.circleMarker(latlng, {
                    radius: 8,
                    fillColor: layerConfig.simpleFillColor,
                    color: layerConfig.simpleOutlineColor,
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                });
            }
        };

        const newLayer = L.geoJSON(geojson, geoJSONOptions);
        
        newLayer.options.pointLayer = hasPoints; 
        newLayer.addTo(map);

        newLayer.eachLayer(layer => { 
            let popupContent = '<table>'; 
            for (const key in layer.feature.properties) { 
                popupContent += `<tr><td><strong>${key}</strong></td><td>${layer.feature.properties[key]}</td></tr>`; 
            } 
            popupContent += '</table>'; 
            layer.bindPopup(popupContent, { maxHeight: 200, minWidth: 200 }); 
        }); 
        
        layerControl.addOverlay(newLayer, name); 
        orderedLayers.unshift(newLayer); 
        currentActiveLayer = newLayer; 
        infoControl.update(); 
        updateVisualization(currentActiveLayer); 
        applyLayerOrder(); 
    }
    infoControl.onAdd = function (map) { this._div = L.DomUtil.create('div', 'info'); L.DomEvent.disableClickPropagation(this._div); L.DomEvent.on(this._div, 'click', function(e) { if (e.target.tagName === 'H4') { this._div.classList.toggle('collapsed'); } }, this); this.update(); return this._div; };
    infoControl.update = function () { let htmlContent = '<h4>Configuración</h4>'; if (orderedLayers.length === 0) { htmlContent += '<p>Cargue un archivo para empezar.</p>'; this._div.innerHTML = htmlContent; return; } htmlContent += `<label>Capas (arrastra para ordenar):</label><ul id="layer-list" class="layer-list">`; orderedLayers.forEach(layer => { const layerId = L.stamp(layer); const isActiveClass = (currentActiveLayer && layerId === L.stamp(currentActiveLayer)) ? 'active' : ''; htmlContent += `<li class="${isActiveClass}" data-layer-id="${layerId}">${layer.options.config.name}</li>`; }); htmlContent += `</ul>`; if (currentActiveLayer) { const config = currentActiveLayer.options.config; htmlContent += `<div class="config-options">`; htmlContent += `<label for="mode-selector">Modo de Visualización:</label><select id="mode-selector">`; htmlContent += `<option value="simple" ${config.displayMode === 'simple' ? 'selected' : ''}>Estilo Simple</option>`; if (config.numericProperties.length > 0) { htmlContent += `<option value="classified" ${config.displayMode === 'classified' ? 'selected' : ''}>Clasificado (Números)</option>`; } if (config.stringProperties.length > 0) { htmlContent += `<option value="categorical" ${config.displayMode === 'categorical' ? 'selected' : ''}>Por Categorías (Texto)</option>`; } htmlContent += `</select>`; if (config.displayMode === 'simple') { htmlContent += `<label for="render-mode-selector">Mostrar:</label><select id="render-mode-selector"><option value="both" ${config.simpleRenderMode === 'both' ? 'selected' : ''}>Relleno y Contorno</option><option value="fill" ${config.simpleRenderMode === 'fill' ? 'selected' : ''}>Solo Relleno</option><option value="outline" ${config.simpleRenderMode === 'outline' ? 'selected' : ''}>Solo Contorno</option></select>`; htmlContent += `<div class="color-picker-container"><label>Relleno:</label><input type="color" id="fill-color-picker" value="${config.simpleFillColor}"></div>`; htmlContent += `<div class="color-picker-container"><label>Contorno:</label><input type="color" id="outline-color-picker" value="${config.simpleOutlineColor}"></div>`; } if (config.displayMode === 'classified') { htmlContent += `<label for="variable-selector">Variable Numérica:</label><select id="variable-selector">`; config.numericProperties.forEach(prop => { htmlContent += `<option value="${prop}" ${prop === config.activeVariable ? 'selected' : ''}>${prop}</option>`; }); htmlContent += `</select>`; htmlContent += `<label for="classes-input">Clases:</label><input type="number" id="classes-input" value="${config.numClasses}" min="2" max="10">`; htmlContent += `<label for="palette-selector">Paleta:</label><select id="palette-selector">`; for (const key in sequentialPalettes) { htmlContent += `<option value="${key}" ${key === config.activePalette ? 'selected' : ''}>${key}</option>`; } htmlContent += `</select>`; } if (config.displayMode === 'categorical') { htmlContent += `<label for="categorical-variable-selector">Variable de Texto:</label><select id="categorical-variable-selector">`; config.stringProperties.forEach(prop => { htmlContent += `<option value="${prop}" ${prop === config.activeCategoricalVariable ? 'selected' : ''}>${prop}</option>`; }); htmlContent += `</select>`; htmlContent += `<label for="categorical-palette-selector">Paleta:</label><select id="categorical-palette-selector">`; for (const key in categoricalPalettes) { htmlContent += `<option value="${key}" ${key === config.activeCategoricalPalette ? 'selected' : ''}>${key}</option>`; } htmlContent += `</select>`; } htmlContent += `</div>`; } this._div.innerHTML = htmlContent; const layerListEl = this._div.querySelector('#layer-list'); if (layerListEl) { sortableInstance = new Sortable(layerListEl, { animation: 150, onEnd: (evt) => { const movedItem = orderedLayers.splice(evt.oldIndex, 1)[0]; orderedLayers.splice(evt.newIndex, 0, movedItem); applyLayerOrder(); infoControl.update(); } }); } this._div.querySelectorAll('#layer-list li').forEach(item => { item.addEventListener('click', () => { const layerId = parseInt(item.dataset.layerId, 10); currentActiveLayer = orderedLayers.find(l => L.stamp(l) === layerId); this.update(); legendControl.update(currentActiveLayer); }); }); if (currentActiveLayer) { const config = currentActiveLayer.options.config; const modeSelector = this._div.querySelector('#mode-selector'); if (modeSelector) { modeSelector.onchange = (e) => { config.displayMode = e.target.value; this.update(); updateVisualization(currentActiveLayer); }; } if (config.displayMode === 'simple') { this._div.querySelector('#render-mode-selector').onchange = (e) => { config.simpleRenderMode = e.target.value; updateVisualization(currentActiveLayer); }; this._div.querySelector('#fill-color-picker').onchange = (e) => { config.simpleFillColor = e.target.value; updateVisualization(currentActiveLayer); }; this._div.querySelector('#outline-color-picker').onchange = (e) => { config.simpleOutlineColor = e.target.value; updateVisualization(currentActiveLayer); }; } if (config.displayMode === 'classified') { this._div.querySelector('#variable-selector').onchange = (e) => { config.activeVariable = e.target.value; updateVisualization(currentActiveLayer); }; this._div.querySelector('#classes-input').onchange = (e) => { let val = parseInt(e.target.value, 10); if (val >= 2 && val <= 10) { config.numClasses = val; updateVisualization(currentActiveLayer); } else { e.target.value = config.numClasses; } }; this._div.querySelector('#palette-selector').onchange = (e) => { config.activePalette = e.target.value; updateVisualization(currentActiveLayer); }; } if (config.displayMode === 'categorical') { this._div.querySelector('#categorical-variable-selector').onchange = (e) => { config.activeCategoricalVariable = e.target.value; updateVisualization(currentActiveLayer); }; this._div.querySelector('#categorical-palette-selector').onchange = (e) => { config.activeCategoricalPalette = e.target.value; updateVisualization(currentActiveLayer); }; } } };
    infoControl.addTo(map);
    legendControl.onAdd = function (map) { this._div = L.DomUtil.create('div', 'info legend'); return this._div; };
    legendControl.update = function (layer) { let content = ""; if (layer && layer.options.config.displayMode === 'classified' && layer.options.config.numericStats[layer.options.config.activeVariable].grades?.length > 1) { const config = layer.options.config; const grades = config.numericStats[config.activeVariable].grades; const palette = sequentialPalettes[config.activePalette]; let labels = ['<h4>' + config.activeVariable + '</h4>']; for (let i = 0; i < grades.length - 1; i++) { if (palette[i]) { labels.push(`<i style="background:${palette[i]}"></i> ${grades[i].toLocaleString(undefined, {maximumFractionDigits: 2})} &ndash; ${grades[i+1].toLocaleString(undefined, {maximumFractionDigits: 2})}`); } } content = labels.join('<br>'); } else if (layer && layer.options.config.displayMode === 'categorical' && layer.options.config.categoricalMap) { const config = layer.options.config; let labels = ['<h4>' + config.activeCategoricalVariable + '</h4>']; for (const value in config.categoricalMap) { labels.push(`<i style="background:${config.categoricalMap[value]}"></i> ${value}`); } content = labels.join('<br>'); } this._div.innerHTML = content; };
    legendControl.addTo(map);
    function applyLayerOrder() { orderedLayers.forEach(layer => layer.bringToFront()); }
    map.on('overlayadd', e => { const index = orderedLayers.findIndex(l => L.stamp(l) === L.stamp(e.layer)); if (index === -1) { orderedLayers.unshift(e.layer); } if (!currentActiveLayer) { currentActiveLayer = e.layer; } applyLayerOrder(); infoControl.update(); legendControl.update(currentActiveLayer); });
    map.on('overlayremove', e => { const layerIdToRemove = L.stamp(e.layer); orderedLayers = orderedLayers.filter(layer => L.stamp(layer) !== layerIdToRemove); if (e.layer === currentActiveLayer) { currentActiveLayer = orderedLayers.length > 0 ? orderedLayers[0] : null; } infoControl.update(); legendControl.update(currentActiveLayer); });
    function handleUploadedFile(file) {
        if (!file) return;
        const extension = file.name.split('.').pop().toLowerCase();
        const reader = new FileReader();

        const loadingMessage = L.DomUtil.create('div', 'loading-indicator', map.getContainer());
        loadingMessage.innerText = `Cargando ${file.name}...`;

        reader.onload = function(event) {
            try {
                if (extension === 'zip') {
                    shp(event.target.result).then(function(geojson){
                        if (Array.isArray(geojson)) {
                            geojson.forEach(featureCollection => {
                                processData(featureCollection, featureCollection.name || file.name);
                            });
                        } else {
                            processData(geojson, file.name);
                        }
                        map.getContainer().removeChild(loadingMessage);
                    }).catch(err => {
                        alert("Error procesando Shapefile: " + err.message);
                        map.getContainer().removeChild(loadingMessage);
                    });
                } else if (extension === 'geojson' || extension === 'json') {
                    processData(JSON.parse(event.target.result), file.name);
                    map.getContainer().removeChild(loadingMessage);
                }
            } catch (err) {
                alert("Error procesando el archivo: " + err.message);
                map.getContainer().removeChild(loadingMessage);
            }
        };
        reader.onerror = function() {
            alert("Error al leer el archivo.");
            map.getContainer().removeChild(loadingMessage);
        };

        if (extension === 'zip') {
            reader.readAsArrayBuffer(file);
        } else {
            reader.readAsText(file);
        }
    }
    
    L.Control.Custom = L.Control.extend({
        onAdd: function(map) {
            const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control custom-control');
            container.innerText = 'Cargar Archivo(s)';
            const fileInput = L.DomUtil.create('input', 'hidden');
            fileInput.type = 'file'; 
            fileInput.accept = ".geojson,.json,.zip"; 
            fileInput.multiple = true;
            container.appendChild(fileInput);

            // Se corrigió para procesar solo los archivos una vez
            fileInput.onchange = (e) => { 
                if (!e.target.files) return; 
                for (const file of e.target.files) { 
                    handleUploadedFile(file); 
                } 
                e.target.value = ''; // Limpiar para que el mismo archivo pueda ser cargado de nuevo
            };
            
            L.DomEvent.on(container, 'click', (e) => { L.DomEvent.stopPropagation(e); fileInput.click(); });
            return container;
        }
    });
    new L.Control.Custom({ position: 'topleft' }).addTo(map);

    // --- FUNCIÓN EXPORTAR MAPA (USANDO LEAFLET-IMAGE) ---
    function exportMap() {
        const controlsToHide = document.querySelectorAll(
            '.leaflet-control-container > .leaflet-top, ' +
            '.leaflet-control-container > .leaflet-bottom-left, ' +
            '.info.leaflet-control'
        );
        controlsToHide.forEach(el => el.classList.add('hide-for-export'));

        leafletImage(map, function(err, canvas) {
            controlsToHide.forEach(el => el.classList.remove('hide-for-export'));
            if (err) {
                console.error("Error al exportar el mapa con leaflet-image:", err);
                alert("Hubo un error al exportar el mapa. Por favor, inténtelo de nuevo.");
            } else {
                const link = document.createElement('a');
                link.download = 'mapa_exportado.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            }
        });
    }

    L.Control.Export = L.Control.extend({
        onAdd: function(map) {
            const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control custom-control');
            container.innerText = 'Exportar Imagen';
            L.DomEvent.on(container, 'click', function(e) { L.DomEvent.stopPropagation(e); exportMap(); });
            return container;
        }
    });
    new L.Control.Export({ position: 'topleft' }).addTo(map);

    // --- LÓGICA PARA LA HERRAMIENTA DE MEDICIÓN CON DESHACER (CTRL+Z) ---
    const drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);

    const drawControl = new L.Control.Draw({
        edit: {
            featureGroup: drawnItems,
            remove: true
        },
        draw: {
            polygon: {
                allowIntersection: false,
                showArea: true
            },
            polyline: true,
            rectangle: true,
            circle: false,
            marker: false
        }
    });
    map.addControl(drawControl);

    // Evento CUANDO SE DIBUJA ALGO
    map.on(L.Draw.Event.CREATED, function (e) {
        const layer = e.layer;
        const type = e.layerType;
        let content = '';

        if (type === 'polyline') {
            let distance = 0;
            const latlngs = layer.getLatLngs();
            for (let i = 0; i < latlngs.length - 1; i++) {
                distance += latlngs[i].distanceTo(latlngs[i+1]);
            }
            content = `Distancia: ${ (distance / 1000).toFixed(2) } km`;
        } else if (type === 'polygon' || type === 'rectangle') {
            const area = L.GeometryUtil.geodesicArea(layer.getLatLngs()[0]);
            content = `Área: ${ (area / 10000).toFixed(2) } hectáreas`;
        }
        
        if (content) {
            layer.bindPopup(content).openPopup();
        }
        
        drawnItems.addLayer(layer);
        
        drawnItemsHistory.push(layer); 
        console.log("Elemento dibujado añadido al historial. Historial actual:", drawnItemsHistory.length);
    });

    // --- Función para deshacer la última acción de dibujo ---
    function undoLastDrawAction() {
        if (drawnItemsHistory.length > 0) {
            const lastDrawnLayer = drawnItemsHistory.pop();
            if (drawnItems.hasLayer(lastDrawnLayer)) {
                drawnItems.removeLayer(lastDrawnLayer);
                console.log("Deshecha la última acción de dibujo. Elementos restantes:", drawnItemsHistory.length);
            } else {
                console.log("El último elemento ya no está en el mapa, o fue removido por otro medio.");
            }
        } else {
            console.log("No hay acciones de dibujo para deshacer.");
        }
    }

    // --- Event Listener para Ctrl+Z ---
    document.addEventListener('keydown', function(event) {
        const isCtrlOrCmdZ = (event.ctrlKey || event.metaKey) && event.key === 'z';
        const isInputTarget = event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA';

        if (isCtrlOrCmdZ && !isInputTarget) {
            event.preventDefault();
            undoLastDrawAction();
        }
    });

    // --- GeoJSON estático 1 (Puntos) ---
    const myStaticGeoJSON1 =
       {
        "type": "FeatureCollection",
        "name": "En proceso de atención puntos",
        "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
        "features": [
            { "type": "Feature", "properties": { "id": 9, "Año": 2025, "Id_sitio": "9", "Sitio": "Bahía de la Paz", "layer": "Proyectos_Restauración_2025_2026_Modificado", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2025_2026_Modificado.shp" }, "geometry": { "type": "Point", "coordinates": [ -110.375117360284605, 24.119716276422341 ] } },
            { "type": "Feature", "properties": { "id": 17, "Año": 2026, "Id_sitio": "56", "Sitio": "Estero de Punta Banda", "layer": "Proyectos_Restauración_2025_2026_Modificado", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2025_2026_Modificado.shp" }, "geometry": { "type": "Point", "coordinates": [ -116.637126542991496, 31.742194390479558 ] } },
            { "type": "Feature", "properties": { "id": 1, "Año": 2050, "Id_sitio": "93", "Sitio": "Río Tijuana", "layer": "Proyectos_Restauración_2050", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2050.shp" }, "geometry": { "type": "Point", "coordinates": [ -117.125323213031436, 32.484916611665213 ] } },
            { "type": "Feature", "properties": { "id": 2, "Año": 2050, "Id_sitio": "105", "Sitio": "Parque Nacional Zona Marina del Archipiélago Espíritu Santo", "layer": "Proyectos_Restauración_2050", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2050.shp" }, "geometry": { "type": "Point", "coordinates": [ -110.353107133979464, 24.480697158322037 ] } },
            { "type": "Feature", "properties": { "id": 3, "Año": 2050, "Id_sitio": "101", "Sitio": "Área de Protección de Flora y Fauna Balandra y su zona de influencia", "layer": "Proyectos_Restauración_2050", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2050.shp" }, "geometry": { "type": "Point", "coordinates": [ -110.31318109870152, 24.298178139908511 ] } },
            { "type": "Feature", "properties": { "id": 4, "Año": 2050, "Id_sitio": "264", "Sitio": "Bahía Altata", "layer": "Proyectos_Restauración_2050", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2050.shp" }, "geometry": { "type": "Point", "coordinates": [ -107.773065345370327, 24.53820966152005 ] } },
            { "type": "Feature", "properties": { "id": 5, "Año": 2050, "Id_sitio": "230", "Sitio": "Río Seco", "layer": "Proyectos_Restauración_2050", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2050.shp" }, "geometry": { "type": "Point", "coordinates": [ -95.733464469290524, 15.917750866059322 ] } },
            { "type": "Feature", "properties": { "id": 6, "Año": 2050, "Id_sitio": "999999", "Sitio": "Laguna San Ignacio", "layer": "Proyectos_Restauración_2050", "path": "C:\\Users\\rigel.zaragoza\\Documents\\Varios\\Sitios de Restauración\\Shp\\Proyectos_Restauración_2050.shp" }, "geometry": { "type": "Point", "coordinates": [ -113.253151342241978, 26.759273615085441 ] } }
        ]
    };

    // --- GeoJSON estático 2 (Polígonos) ---
    const myStaticGeoJSON2 = {
        "type": "FeatureCollection",
        "name": "En proceso de atención poligono",
        "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
        "features": [
        { "type": "Feature", "properties": { "NUM_ANP": 20, "ID_ANP": "ANP00803020", "ID_DOF": "8.3.01.020", "NOMBRE": "Lagunas de Chacahua", "CAT_MANEJO": "PN", "ESTADOS": "Oaxaca", "REGION": "Frontera Sur, Istmo y Pacífico Sur", "SUPERFICIE": 14896.0734, "S_TERRES": 14896.0734, "S_MARINA": 0.0, "PRIM_DEC": "1937-07-09", "ULT_DOF": "1937-07-09", "PM": "2013-11-11", "CERT_SINAP": null, "ID_restauc": 1, "Año": 2026 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -97.662831038657998, 16.040578415969492 ], [ -97.67504439724371, 16.003089024509848 ], [ -97.673228826708907, 16.003779404283137 ], [ -97.672885737285014, 16.003909467665778 ], [ -97.670878740748378, 16.004220180389211 ], [ -97.670291269842437, 16.004300149884443 ], [ -97.669299787396426, 16.004270292456965 ], [ -97.668285212224532, 16.004199616650396 ], [ -97.667285622012969, 16.004159531984499 ], [ -97.666324388175553, 16.003970554464843 ], [ -97.664462482749286, 16.004330684494278 ], [ -97.66320358233861, 16.004291229494129 ], [ -97.662311276233481, 16.004189652602179 ], [ -97.661898833988175, 16.004119302077129 ], [ -97.661128703216946, 16.004620632340277 ], [ -97.659243906143388, 16.005349997922622 ], [ -97.657245060069386, 16.005660630088812 ], [ -97.656718647820242, 16.00569123414823 ], [ -97.654712076700491, 16.005580401412317 ], [ -97.652759039114414, 16.005059790718917 ], [ -97.650973874826377, 16.0041504569881 ], [ -97.650500668509892, 16.00390911319306 ], [ -97.649562389190578, 16.003170023660516 ], [ -97.648952105781177, 16.002640862860176 ], [ -97.647708125296106, 16.001241209281034 ], [ -97.647288312408932, 16.000350596946021 ], [ -97.646639946924495, 15.999491308233473 ], [ -97.646174543432323, 15.998870414005921 ], [ -97.645327268697883, 15.997101562952196 ], [ -97.644892536619409, 15.99521103768501 ], [ -97.644739695864075, 15.99431080586578 ], [ -97.640459674390968, 15.994301875614951 ], [ -97.640032436387571, 15.995050447525728 ], [ -97.639032990665385, 15.99613092918878 ], [ -97.637629741452542, 15.997161399145796 ], [ -97.636569197377753, 15.997770382359874 ], [ -97.635394324634149, 15.998271309961126 ], [ -97.634570085412122, 15.998650186799864 ], [ -97.633860408396401, 15.999100960991655 ], [ -97.632334791013932, 15.999650479875754 ], [ -97.630923248226395, 16.000170210819931 ], [ -97.629984938760344, 16.000661315139098 ], [ -97.627864300517274, 16.001281570131709 ], [ -97.626391801937245, 16.001571545678189 ], [ -97.625567679329492, 16.001670213868636 ], [ -97.624064618707109, 16.001729513407781 ], [ -97.621974159139256, 16.00159976324602 ], [ -97.620470968068787, 16.001420664680893 ], [ -97.618693792629529, 16.001340340969136 ], [ -97.617755355859913, 16.001330920482701 ], [ -97.616488631618608, 16.001161222373469 ], [ -97.615443078669216, 16.00093080659525 ], [ -97.613764747517905, 16.001001331611292 ], [ -97.612254103558769, 16.001060498836921 ], [ -97.610759044709766, 16.000890422766872 ], [ -97.609194968871861, 16.00048038933852 ], [ -97.608264294634012, 16.000021349237102 ], [ -97.607844332535308, 15.999860469594353 ], [ -97.607523921435416, 16.000000739196707 ], [ -97.607119347565572, 16.000150630495341 ], [ -97.607767940450572, 16.000780695917967 ], [ -97.60811892328428, 16.001121884308702 ], [ -97.608928116927302, 16.002349478200699 ], [ -97.609378220780627, 16.003140934574731 ], [ -97.609614512524558, 16.003601129199012 ], [ -97.609942715351281, 16.004199743817878 ], [ -97.610408157639597, 16.00496983302537 ], [ -97.610858446488237, 16.005650575626305 ], [ -97.611094744201694, 16.006110769025099 ], [ -97.611453741492085, 16.006989751387209 ], [ -97.611674927533954, 16.007439679192601 ], [ -97.612132827478206, 16.008460514622129 ], [ -97.612353954606078, 16.008919479283065 ], [ -97.612712834289766, 16.010329427849513 ], [ -97.612834977152431, 16.011769479905922 ], [ -97.612712647849662, 16.013430508192755 ], [ -97.612354327128457, 16.014840343701906 ], [ -97.611759366120964, 16.016178606224059 ], [ -97.610966040153926, 16.017399222549386 ], [ -97.609958741224602, 16.018478365220062 ], [ -97.608791899833534, 16.019399437972879 ], [ -97.607495021390605, 16.020118570614159 ], [ -97.606083348141169, 16.020627951908978 ], [ -97.604610669778538, 16.020920021395966 ], [ -97.603115646430751, 16.02097921364782 ], [ -97.60252073203543, 16.020858982039101 ], [ -97.601612339184271, 16.020799971582164 ], [ -97.600163065531547, 16.020408685098573 ], [ -97.599575226113586, 16.02027945390256 ], [ -97.598583539349647, 16.019850471235202 ], [ -97.597973505578466, 16.019890547922216 ], [ -97.596828835133806, 16.019878552248599 ], [ -97.595661346391296, 16.020799543387795 ], [ -97.594364417788199, 16.021518591213862 ], [ -97.592953292126651, 16.022027885498858 ], [ -97.592128992149242, 16.022138841948561 ], [ -97.591076624139532, 16.022458424608601 ], [ -97.590359030332365, 16.022678526344578 ], [ -97.588894514939, 16.02296827810261 ], [ -97.587391359374863, 16.023019396712414 ], [ -97.586369050727512, 16.023298483409292 ], [ -97.584904527223216, 16.023588206798536 ], [ -97.582935865614445, 16.023639613383352 ], [ -97.581433097288482, 16.02346813982831 ], [ -97.579983406401141, 16.023057509449757 ], [ -97.578625129862814, 16.022438479546508 ], [ -97.577389160956102, 16.021620294457193 ], [ -97.576305759805336, 16.02061897296943 ], [ -97.575405121190727, 16.019459571257755 ], [ -97.574832919337268, 16.018439040772364 ], [ -97.57458150008722, 16.018229506410592 ], [ -97.573680953101359, 16.017059932022676 ], [ -97.572879991760203, 16.017010551774149 ], [ -97.571659043550824, 16.016969672254845 ], [ -97.570164123351105, 16.017019597093679 ], [ -97.568668494906206, 16.016839047649512 ], [ -97.567218804574509, 16.01643963255259 ], [ -97.565860617545184, 16.015820527689414 ], [ -97.565281133419319, 16.01558958705067 ], [ -97.564472191202753, 16.015019331023041 ], [ -97.56370173374961, 16.014540835262324 ], [ -97.562778080590135, 16.013841020516111 ], [ -97.562144930885665, 16.013190594728371 ], [ -97.561694797446251, 16.012839633438318 ], [ -97.561244992895922, 16.012031145773221 ], [ -97.56032129582411, 16.011340359035387 ], [ -97.559513033617634, 16.010761053300769 ], [ -97.558734445160212, 16.010280227597434 ], [ -97.558055198013051, 16.009709690473073 ], [ -97.556964425417505, 16.008700324314589 ], [ -97.556048769467168, 16.007540751193517 ], [ -97.555567786621964, 16.006850662357294 ], [ -97.554118208697332, 16.006450036134424 ], [ -97.553538767005023, 16.006219066693177 ], [ -97.552180696237258, 16.005599883199352 ], [ -97.550944442979983, 16.004770260474515 ], [ -97.550250054086121, 16.00419959916502 ], [ -97.549159278983893, 16.003200365053942 ], [ -97.548472181311638, 16.002510000402083 ], [ -97.547663508379173, 16.002161109185181 ], [ -97.546427807113503, 16.001341634000426 ], [ -97.545344082642202, 16.000341300750961 ], [ -97.544642027292696, 15.999541243951796 ], [ -97.543741666998358, 15.998381729255811 ], [ -97.542704048601763, 15.996901578126142 ], [ -97.542001961340645, 15.995621395143985 ], [ -97.541528853582236, 15.99425238885749 ], [ -97.541422376902858, 15.993791882095536 ], [ -97.54097218868219, 15.992322488004334 ], [ -97.540727793139524, 15.990901937221736 ], [ -97.5407503267989, 15.988742120525217 ], [ -97.540742637782728, 15.987862038766821 ], [ -97.540750160321181, 15.987302892554112 ], [ -97.540903210412239, 15.986482645315277 ], [ -97.540902841855882, 15.985802568450026 ], [ -97.540910371426946, 15.985242292454132 ], [ -97.540902945326138, 15.984812959212263 ], [ -97.540910274396197, 15.983792897233059 ], [ -97.541040124954861, 15.983112573835228 ], [ -97.541040328187592, 15.983002995092022 ], [ -97.540643529959709, 15.982882815331266 ], [ -97.540117162101012, 15.982672509861345 ], [ -97.538850383593058, 15.981972537384195 ], [ -97.538339193711579, 15.981763460620471 ], [ -97.536820716942543, 15.981392765792748 ], [ -97.536256536467079, 15.98108278142837 ], [ -97.535882230400375, 15.981083623153665 ], [ -97.535417123240052, 15.980962969215057 ], [ -97.533921643747817, 15.980563039217145 ], [ -97.533456465917425, 15.98045254789082 ], [ -97.531678551351035, 15.979543447061758 ], [ -97.53134255764428, 15.979253083000572 ], [ -97.53013741904806, 15.978273320767471 ], [ -97.529908583259441, 15.978103433727711 ], [ -97.529709820677226, 15.97789308324775 ], [ -97.528572921675277, 15.976442700107953 ], [ -97.528412834723497, 15.976133200656648 ], [ -97.52764226665272, 15.974574609554224 ], [ -97.527497295141131, 15.974194042750582 ], [ -97.527062038585541, 15.9722943197512 ], [ -97.527008600981048, 15.972013791663528 ], [ -97.527062082210193, 15.970354647603358 ], [ -97.527008718532613, 15.970063952834664 ], [ -97.527115258275046, 15.969704311766066 ], [ -97.527222075743452, 15.969064510081523 ], [ -97.528641467887269, 15.969233503391024 ], [ -97.530671016684266, 15.969324186156655 ], [ -97.532875588895365, 15.969273701846078 ], [ -97.534805660328743, 15.969313960926058 ], [ -97.536545531117611, 15.969333704773305 ], [ -97.536719229610185, 15.969282073916929 ], [ -97.536758739013464, 15.96929626932905 ], [ -97.536767273636883, 15.969346187403005 ], [ -97.536789575562238, 15.96938618547739 ], [ -97.536805550266308, 15.96941094845107 ], [ -97.536800214899642, 15.969453903718374 ], [ -97.536808220528599, 15.96949814262598 ], [ -97.536824601796582, 15.96953391607525 ], [ -97.536830611621667, 15.96957897286876 ], [ -97.536839582484674, 15.969625396381787 ], [ -97.538719739020905, 15.967334234144801 ], [ -97.539055599555297, 15.967154633114944 ], [ -97.539360296112022, 15.96692398390087 ], [ -97.53958185643603, 15.966724401656847 ], [ -97.539757445183056, 15.966584381069879 ], [ -97.54032914294055, 15.966574701573904 ], [ -97.540932377415004, 15.966564104573308 ], [ -97.541420274286793, 15.966434106670363 ], [ -97.541801745254588, 15.966244642735546 ], [ -97.542091768111163, 15.966024057106267 ], [ -97.542335730190416, 15.965794121641125 ], [ -97.542526707183868, 15.965624830677143 ], [ -97.54286996796526, 15.965633932172352 ], [ -97.543190231710298, 15.965674508963673 ], [ -97.543319856659878, 15.9656742562874 ], [ -97.543739813640173, 15.965654503201506 ], [ -97.544235910144096, 15.965765179008486 ], [ -97.544525729485144, 15.965654168842093 ], [ -97.544846036694253, 15.96544395112187 ], [ -97.545120503243822, 15.965275221858235 ], [ -97.545486744481252, 15.965255102288609 ], [ -97.545898827873827, 15.965274831021361 ], [ -97.546120118613317, 15.965275195641709 ], [ -97.546554864853931, 15.965473568103278 ], [ -97.546906146808453, 15.965504181456026 ], [ -97.547317784405266, 15.965504699645976 ], [ -97.547798554600661, 15.965554260260774 ], [ -97.54809582028679, 15.965544967976314 ], [ -97.548385992396163, 15.965384248082387 ], [ -97.548607481623719, 15.965275030866167 ], [ -97.548866696833102, 15.96503389309629 ], [ -97.549019415425732, 15.964824798583038 ], [ -97.549179377341886, 15.964664329714992 ], [ -97.54927862149168, 15.964584789855508 ], [ -97.549514870768064, 15.964534415284334 ], [ -97.5497820038957, 15.964574624236207 ], [ -97.549881062388692, 15.964684872005876 ], [ -97.549866352989, 15.96486439484886 ], [ -97.549881371870072, 15.965214702209948 ], [ -97.549965552295816, 15.965364389177296 ], [ -97.550171393366952, 15.965484393494876 ], [ -97.550499112631655, 15.965544214447334 ], [ -97.55079688991998, 15.965545089104694 ], [ -97.551285102624377, 15.965533688315759 ], [ -97.551597923626844, 15.965553867934943 ], [ -97.552002615350773, 15.965463954484221 ], [ -97.552330446159772, 15.965344151345278 ], [ -97.552566956162195, 15.9651751567975 ], [ -97.552918017203126, 15.965154922330953 ], [ -97.553337679193191, 15.965094479007689 ], [ -97.553611924719462, 15.964873770559734 ], [ -97.553695887693721, 15.964643875884519 ], [ -97.553711386359453, 15.964434985630305 ], [ -97.55377987397469, 15.96416431778249 ], [ -97.553924629836558, 15.963924663932346 ], [ -97.554107855638279, 15.96369430584258 ], [ -97.554405408805621, 15.963315594678818 ], [ -97.554527270358335, 15.963175200190051 ], [ -97.554718026625721, 15.963035267979194 ], [ -97.554985117059857, 15.96283484397253 ], [ -97.555366728826186, 15.962705229206506 ], [ -97.555656906035608, 15.96262470734888 ], [ -97.555877755243102, 15.962604724036453 ], [ -97.556381660073498, 15.962684921946789 ], [ -97.556785877325296, 15.962825454530957 ], [ -97.556989705300396, 15.962888620755223 ], [ -97.557000556191724, 15.962891983433678 ], [ -97.557266524180818, 15.962974406310764 ], [ -97.557586818815992, 15.963175379098118 ], [ -97.557975904389309, 15.963473966370032 ], [ -97.557986813080277, 15.963478321736204 ], [ -97.558326993513276, 15.963614140478967 ], [ -97.558876587298073, 15.963674303971118 ], [ -97.559158742721706, 15.963654727554513 ], [ -97.559547612360348, 15.963599748364288 ], [ -97.559558277577253, 15.963598240479257 ], [ -97.559585990864264, 15.963594322275185 ], [ -97.559728643927485, 15.963511172043241 ], [ -97.559928979218, 15.963394399371339 ], [ -97.560112494034684, 15.963204706744079 ], [ -97.56050135873528, 15.963205046827397 ], [ -97.560692152093111, 15.963224397222803 ], [ -97.560966965509294, 15.963334685060715 ], [ -97.560991596642452, 15.963384309303535 ], [ -97.561065982650575, 15.96353417428071 ], [ -97.561099560941614, 15.963539011588125 ], [ -97.561485369244167, 15.96359459078127 ], [ -97.56159250288448, 15.963554637049413 ], [ -97.561638916263348, 15.963494071420087 ], [ -97.561760459906054, 15.96333546671417 ], [ -97.561789165168534, 15.963323087003971 ], [ -97.562111276591622, 15.963184169593944 ], [ -97.562355104353799, 15.963134960692798 ], [ -97.562576825266035, 15.9630743069294 ], [ -97.564346487067098, 15.963004771811825 ], [ -97.56607067159257, 15.963174416510242 ], [ -97.567356190287796, 15.963920590393855 ], [ -97.567535493192963, 15.964024664577607 ], [ -97.567658571225763, 15.964044928487624 ], [ -97.569237309799405, 15.964304846894606 ], [ -97.57147267111867, 15.964854036693851 ], [ -97.573921927501374, 15.965544704158731 ], [ -97.575775756385895, 15.965883457524171 ], [ -97.577370165694049, 15.966163996222406 ], [ -97.578125478427978, 15.966533880524423 ], [ -97.58016243458718, 15.96707376465082 ], [ -97.580171831648386, 15.967076320691547 ], [ -97.582405614851211, 15.9676839000943 ], [ -97.582820192293752, 15.967760644671614 ], [ -97.586189691310778, 15.968384344401841 ], [ -97.588126570722125, 15.969017014333758 ], [ -97.589157964850529, 15.969353900652607 ], [ -97.590181483893673, 15.969495339803643 ], [ -97.591835545303354, 15.96972389756661 ], [ -97.593460900692605, 15.970013559740323 ], [ -97.596016552889921, 15.970624468225196 ], [ -97.597809578143085, 15.970903894144385 ], [ -97.599625654643091, 15.971313372827865 ], [ -97.600701051912495, 15.971593755601759 ], [ -97.60232667968603, 15.971763603643524 ], [ -97.603882961225395, 15.97225383033674 ], [ -97.606667795487624, 15.972833339262706 ], [ -97.60807914431058, 15.973173475490171 ], [ -97.609742305973384, 15.97349376397284 ], [ -97.611596567010508, 15.97396326584294 ], [ -97.613313123115688, 15.974333579431288 ], [ -97.613945901780369, 15.974534225603634 ], [ -97.615396061857098, 15.974924272777969 ], [ -97.615929574111362, 15.974953686537901 ], [ -97.616425778179519, 15.974973821444109 ], [ -97.616852881843954, 15.975022884184284 ], [ -97.617150481622559, 15.975053038801548 ], [ -97.617531964299019, 15.97511310445924 ], [ -97.617905610372247, 15.975123411224672 ], [ -97.618302413233266, 15.975163238801827 ], [ -97.618722434461915, 15.975223549663156 ], [ -97.618989533803131, 15.975273841155399 ], [ -97.619607485882682, 15.975423538341431 ], [ -97.619996669786019, 15.975553692091978 ], [ -97.620217887947774, 15.97565339599646 ], [ -97.620690738664109, 15.975673371462392 ], [ -97.621316305546884, 15.97573386422107 ], [ -97.621682787852592, 15.975853702106804 ], [ -97.622170999358843, 15.975933648201362 ], [ -97.62233079922953, 15.975962913893625 ], [ -97.622712415990748, 15.976003765992743 ], [ -97.623032867744598, 15.976022761449883 ], [ -97.623330264159904, 15.976083408947375 ], [ -97.623650708530079, 15.9761035331681 ], [ -97.624001929093595, 15.976062848277991 ], [ -97.624291632660004, 15.97605227242525 ], [ -97.62467331903548, 15.976082953939454 ], [ -97.625260461688356, 15.97621323301604 ], [ -97.625497002743202, 15.976292694390224 ], [ -97.625809986850754, 15.976293562387639 ], [ -97.626260472534682, 15.976253507257582 ], [ -97.626611418549317, 15.976253486535143 ], [ -97.627030869594705, 15.976312647976954 ], [ -97.627290089469057, 15.97649279793518 ], [ -97.627412108721217, 15.976582824419779 ], [ -97.627831870325053, 15.976682656591777 ], [ -97.628197999043437, 15.976682730062805 ], [ -97.628717044514815, 15.976693944391116 ], [ -97.62896885583757, 15.976674083055627 ], [ -97.629426468764734, 15.976702980162884 ], [ -97.630280772335936, 15.976702767662118 ], [ -97.630723394137647, 15.976703323367644 ], [ -97.631402294434054, 15.976822872088974 ], [ -97.632028273416154, 15.976823460711785 ], [ -97.632623107601034, 15.976853222736111 ], [ -97.633172260076378, 15.976903028310915 ], [ -97.633729185525226, 15.977012757601983 ], [ -97.634271331953414, 15.977062515936836 ], [ -97.634660477623243, 15.97711356227876 ], [ -97.634973320170332, 15.977222870310015 ], [ -97.635346776486585, 15.977262518644011 ], [ -97.635873370264619, 15.977193552461756 ], [ -97.636437843323108, 15.97722311159697 ], [ -97.637086218016634, 15.977193324451264 ], [ -97.637788231092827, 15.977263291203315 ], [ -97.638383136811285, 15.977282870128249 ], [ -97.63914608252685, 15.977322714927539 ], [ -97.639596298154117, 15.97732330026696 ], [ -97.63999297697228, 15.977383422458843 ], [ -97.640351688697251, 15.977532553235335 ], [ -97.640626505425359, 15.977652910463519 ], [ -97.641297906624004, 15.977672964244391 ], [ -97.641816381613978, 15.977683013520448 ], [ -97.646127396810869, 15.977632209376281 ], [ -97.648522736242626, 15.977632569141861 ], [ -97.651377807952827, 15.977661010638826 ], [ -97.651582408182094, 15.97766304670256 ], [ -97.654519407515522, 15.977612502366014 ], [ -97.656419390108283, 15.977462811425141 ], [ -97.658855365964541, 15.977343130111592 ], [ -97.658868086816824, 15.977342505021227 ], [ -97.658877243295251, 15.977341556609701 ], [ -97.660699424166296, 15.977152806954336 ], [ -97.66103352889337, 15.977049412505096 ], [ -97.66208795476723, 15.97672309650045 ], [ -97.663301181791553, 15.976620515755144 ], [ -97.664212967357628, 15.976543415862068 ], [ -97.664216449579499, 15.976543121397185 ], [ -97.665117440294807, 15.976142461688028 ], [ -97.665566966295557, 15.97594256011098 ], [ -97.665799520013366, 15.975866103148292 ], [ -97.666963263773027, 15.9754834911692 ], [ -97.668618770701642, 15.975032793276682 ], [ -97.669900422246371, 15.974333489123069 ], [ -97.671632419605146, 15.973702479193605 ], [ -97.672608585608714, 15.973013700780086 ], [ -97.673852392302024, 15.972383052301041 ], [ -97.674237653814828, 15.971777539780419 ], [ -97.674327963108851, 15.971635600570494 ], [ -97.674546200939403, 15.97129259470131 ], [ -97.675446700092152, 15.970293784745479 ], [ -97.675920936867954, 15.97005456929179 ], [ -97.676041924892445, 15.969993539917709 ], [ -97.676598683169971, 15.968963238473577 ], [ -97.676598775022285, 15.96896294663253 ], [ -97.676850295365796, 15.968163790476183 ], [ -97.676712633014574, 15.967422958800682 ], [ -97.675492265483342, 15.965084788291733 ], [ -97.675415787683335, 15.96481317833053 ], [ -97.676041420202012, 15.964413701029912 ], [ -97.676460735795217, 15.963954208030884 ], [ -97.676540921479727, 15.963876965023474 ], [ -97.67681497254307, 15.963612970284885 ], [ -97.676949021422331, 15.963483839844002 ], [ -97.677986886495432, 15.963264256750392 ], [ -97.678615862676054, 15.963162896844494 ], [ -97.678985175315574, 15.963103380578843 ], [ -97.67898641611032, 15.963103180618077 ], [ -97.679565902515321, 15.962704539004278 ], [ -97.68054232625849, 15.962684532794469 ], [ -97.682236314149293, 15.962854188672793 ], [ -97.68392251839856, 15.962963906816128 ], [ -97.686027971149031, 15.96307390775678 ], [ -97.688996133258797, 15.96332357652102 ], [ -97.6907888846265, 15.963573978463216 ], [ -97.692207748327974, 15.963853731225299 ], [ -97.694351704853659, 15.964063303056491 ], [ -97.696038079552807, 15.964423733810747 ], [ -97.700546723709294, 15.965303923267129 ], [ -97.704270021407979, 15.966003058711465 ], [ -97.710236349181628, 15.967232992527727 ], [ -97.712266010977828, 15.967613428163077 ], [ -97.715195669298737, 15.968062477086278 ], [ -97.718026117076249, 15.968783170455993 ], [ -97.721238224298929, 15.969172810165844 ], [ -97.723305704615029, 15.969582741594365 ], [ -97.724236408613876, 15.969783700998846 ], [ -97.725762489398903, 15.970303381891313 ], [ -97.728615874146499, 15.970542792420019 ], [ -97.730172548752023, 15.971122501139121 ], [ -97.733475739849894, 15.971713596293284 ], [ -97.736481799033186, 15.972292732307096 ], [ -97.739136892532088, 15.972782782044931 ], [ -97.740930224588737, 15.973062149293412 ], [ -97.742722971834667, 15.973342628131206 ], [ -97.745347709727753, 15.973552240638696 ], [ -97.746827871775338, 15.973862499998916 ], [ -97.749352865688593, 15.974341501068864 ], [ -97.750802644313353, 15.974752107643155 ], [ -97.7528929381578, 15.974891874419995 ], [ -97.755585998239553, 15.975012505261645 ], [ -97.758378716449329, 15.975262471302585 ], [ -97.760278572023253, 15.975511788101642 ], [ -97.762247056757758, 15.975711771800718 ], [ -97.764421162958513, 15.975901618183116 ], [ -97.767213870640148, 15.976351441719885 ], [ -97.768663165975113, 15.97656195520193 ], [ -97.770356967961675, 15.976802098275698 ], [ -97.771356257325579, 15.977072165125321 ], [ -97.772043292282035, 15.977411625820764 ], [ -97.773149273265744, 15.977711666702874 ], [ -97.774347467743041, 15.978021264592257 ], [ -97.775659502841734, 15.978531474965393 ], [ -97.776277236902274, 15.978841154712313 ], [ -97.777307515432142, 15.97901081949783 ], [ -97.778451831107532, 15.97925117248883 ], [ -97.778787744952353, 15.979521965320544 ], [ -97.779177001373228, 15.979662004196882 ], [ -97.78000816972326, 15.979731107249904 ], [ -97.781137536444135, 15.980031240546452 ], [ -97.782419249070642, 15.980441818196198 ], [ -97.784112888103039, 15.98062084535087 ], [ -97.784646947922795, 15.980961664268534 ], [ -97.785692648366535, 15.981290677173263 ], [ -97.786730247530102, 15.981411757848889 ], [ -97.787592393416503, 15.981870784578064 ], [ -97.788393014250346, 15.982070739796825 ], [ -97.788492465360093, 15.982630546010114 ], [ -97.788744432222984, 15.983370846233186 ], [ -97.789163818695783, 15.984240883104349 ], [ -97.789133630454671, 15.98479996085058 ], [ -97.788660584313675, 15.984900114029301 ], [ -97.788415958386963, 15.98459956469668 ], [ -97.788254763791542, 15.98455616934325 ], [ -97.788113276409774, 15.984438833574075 ], [ -97.787974290171519, 15.984339299232261 ], [ -97.787868295758926, 15.984169379001116 ], [ -97.787719683269131, 15.984005898377404 ], [ -97.787550124950371, 15.983878037431396 ], [ -97.787406367248366, 15.983727861238833 ], [ -97.787305506319399, 15.983588826528717 ], [ -97.787189873802447, 15.983443372796103 ], [ -97.787064846535316, 15.983331597214772 ], [ -97.786936588952358, 15.983217833032711 ], [ -97.786790053238747, 15.983156126140443 ], [ -97.786719402272638, 15.983136151465601 ], [ -97.786646882139053, 15.983109974988224 ], [ -97.786592759190796, 15.983087065462769 ], [ -97.786550551946277, 15.983066898347488 ], [ -97.78651358708214, 15.98304194330376 ], [ -97.786503357104891, 15.983029150703032 ], [ -97.786459376953928, 15.983019557479224 ], [ -97.786423962462777, 15.983013537419538 ], [ -97.786403026182825, 15.982998894949901 ], [ -97.786356218167157, 15.983013833898497 ], [ -97.786302278642836, 15.983029139408245 ], [ -97.786223876616134, 15.983011597436644 ], [ -97.786167008848906, 15.982972647388294 ], [ -97.786113757672354, 15.982903827925952 ], [ -97.786025601161214, 15.982847040746549 ], [ -97.785928081249494, 15.982798253952751 ], [ -97.785840748505336, 15.982752199842366 ], [ -97.785817598799383, 15.982740527502131 ], [ -97.785818152111631, 15.982740187162108 ], [ -97.785818219348243, 15.982739880237489 ], [ -97.785817724090521, 15.982739886486172 ], [ -97.78581699503053, 15.982739927571515 ], [ -105.483601309614698, 21.743523326774721 ], [ -105.483599141681623, 21.742904462042304 ], [ -105.483617390822246, 21.742664991446588 ], [ -105.48364293521746, 21.741831473579566 ], [ -105.483699844248008, 21.741759030394803 ], [ -105.485903675995701, 21.743993160670584 ], [ -105.485961477444278, 21.743496087382994 ], [ -105.486552437258979, 21.743984479177584 ], [ -105.487229788565855, 21.74505534679065 ], [ -105.488546876884584, 21.74664607292101 ], [ -105.48877503262645, 21.747453996502202 ], [ -105.489370199745792, 21.747635188658421 ], [ -105.49085798381833, 21.746139983410103 ], [ -105.491548639779012, 21.745907461153706 ], [ -105.492279826030767, 21.747353173568001 ], [ -105.492983185164974, 21.747384869587847 ], [ -105.493355287453426, 21.747575746159157 ], [ -105.49377735276795, 21.748322100661596 ], [ -105.493345404751551, 21.749071092114264 ], [ -105.493368327296423, 21.749156852468502 ], [ -105.492979639149326, 21.74915123469998 ], [ -105.492781821489984, 21.749278308169949 ], [ -105.492630837133163, 21.749640141574616 ], [ -105.492655192193865, 21.750146006567206 ], [ -105.49284048756931, 21.75074173831149 ], [ -105.493021910367588, 21.750854130415803 ], [ -105.492844096234023, 21.749616920179335 ], [ -105.493760733364752, 21.749288219814275 ], [ -105.493836545299814, 21.750049881214522 ], [ -105.494172479463487, 21.750182138801847 ], [ -105.495869476457528, 21.755887015189103 ], [ -105.495810502126858, 21.756399904782654 ], [ -105.495202318922736, 21.756891852457613 ], [ -105.495697445386611, 21.756822610486154 ], [ -105.49591149695874, 21.756914573609492 ], [ -105.496041778623749, 21.757198772575578 ], [ -105.496355131889743, 21.757340127602617 ], [ -105.496165719054318, 21.757720148323131 ], [ -105.495715191284887, 21.757484340825158 ], [ -105.495144236799092, 21.757750312085648 ], [ -105.495320739036856, 21.758088580796084 ], [ -105.495800425588584, 21.757915486942863 ], [ -105.495806882980617, 21.758753877139441 ], [ -105.49878309985769, 21.762821153444179 ], [ -105.499317077803539, 21.766289000246957 ], [ -105.498870888799104, 21.766646128096738 ], [ -105.504214259017147, 21.772653993042866 ], [ -105.509305441730248, 21.779296766611424 ], [ -105.516594888504699, 21.788648475831621 ], [ -105.526503287850687, 21.803616035514437 ], [ -105.527419907160663, 21.806699026305466 ], [ -105.529776593336919, 21.807422284270615 ], [ -105.53061041851862, 21.806651675239095 ], [ -105.550835167798482, 21.838835495617104 ], [ -105.528485949178958, 21.848082197541771 ], [ -105.541316875883808, 21.871855874447249 ], [ -105.538147555190278, 21.87344727927649 ], [ -105.537685724501216, 21.872893622111576 ], [ -105.537349596909678, 21.872952267920368 ], [ -105.538520456438732, 21.875244090252068 ], [ -105.532790454276551, 21.875529868297235 ], [ -105.53097498946687, 21.871859351185606 ], [ -105.530498903561352, 21.872153871163277 ], [ -105.527967890834304, 21.868114123801035 ], [ -105.523021471723098, 21.858520320439538 ], [ -105.521268003480145, 21.859003254766378 ], [ -105.52352390867452, 21.863233080263512 ], [ -105.518166136247999, 21.865703134772389 ], [ -105.515567590865317, 21.860597332834345 ], [ -105.513164779503711, 21.861114283714983 ], [ -105.533741962361717, 21.899213918213832 ], [ -105.534714660411453, 21.898790029605038 ], [ -105.542071261807507, 21.911630199741921 ], [ -105.544797614291724, 21.917764291909293 ], [ -105.545455274742267, 21.917600487707261 ], [ -105.553256866124627, 21.931902994214568 ], [ -105.56268153171726, 21.955360495609966 ], [ -105.561642113100731, 21.955910266562626 ], [ -105.592978883116587, 22.015892056473035 ], [ -105.604455765540877, 22.005103601819314 ], [ -105.614393419867213, 22.032424577257984 ], [ -105.617952903560081, 22.031541922306531 ], [ -105.623090394335804, 22.051864896041366 ], [ -105.623685366865743, 22.051807070421489 ], [ -105.62360259301272, 22.051030541407783 ], [ -105.625802802604028, 22.050735131227555 ], [ -105.623787097540742, 22.04344559720812 ], [ -105.623840429341101, 22.033105009723158 ], [ -105.621316441482747, 22.032152827159962 ], [ -105.618116532480997, 22.01203862432601 ], [ -105.619831151486153, 22.00215960147699 ], [ -105.614495177779531, 21.98999625679545 ], [ -105.604627707468751, 21.958786764652302 ], [ -105.60168674850155, 21.957778862202474 ], [ -105.600422661468372, 21.95599452459021 ], [ -105.596494223529703, 21.943719341740803 ], [ -105.596803291353808, 21.943570960976444 ], [ -105.587522020435529, 21.916829450060561 ], [ -105.585608039242231, 21.910304009783204 ], [ -105.588743813398764, 21.909014643684486 ], [ -105.588438025726759, 21.908295702034138 ], [ -105.59074608415807, 21.907524935496951 ], [ -105.596027390499842, 21.907256995656496 ], [ -105.605701169852068, 21.921735900057797 ], [ -105.609542976422574, 21.929076783981827 ], [ -105.610015171904479, 21.93118200592312 ], [ -105.611729332337518, 21.930728079302014 ], [ -105.615371453130649, 21.942730323700005 ], [ -105.616283843541964, 21.942886359357999 ], [ -105.617488082115358, 21.94772546038547 ], [ -105.616577224053003, 21.948022132438098 ], [ -105.617773971711642, 21.960369156118873 ], [ -105.633077962468178, 21.969041987367063 ], [ -105.635129508947159, 21.973872508916031 ], [ -105.643157940267372, 22.002611372738102 ], [ -105.644812569720671, 22.014642871902709 ], [ -105.642844163048039, 22.074068290863806 ], [ -105.626264283007004, 22.073551719551347 ], [ -105.628666085613645, 22.095863282638504 ], [ -105.630313953179439, 22.095791529203154 ], [ -105.630442224051933, 22.097192489224767 ], [ -105.632453680809022, 22.097108921833183 ], [ -105.631966318946127, 22.101128164022725 ], [ -105.630260076188677, 22.101319410059148 ], [ -105.629767469560534, 22.100241829118033 ], [ -105.628761284110738, 22.100174695913438 ], [ -105.629423066176514, 22.108947833217712 ], [ -105.631126736799956, 22.109051023970551 ], [ -105.633159323792427, 22.109080921069221 ], [ -105.633171235974089, 22.108144134278518 ], [ -105.634226967807024, 22.108242846617088 ], [ -105.634244569414932, 22.11211422868729 ], [ -105.635241281783408, 22.112189945488808 ], [ -105.635561181791388, 22.115598870931194 ], [ -105.634585752626947, 22.11564810502 ], [ -105.634972867286365, 22.121336598215805 ], [ -105.636801478073778, 22.12141891416627 ], [ -105.636841856456215, 22.129240326949343 ], [ -105.636084972992023, 22.129243277909495 ], [ -105.636126933260982, 22.13325494263313 ], [ -105.636994166929583, 22.133226265191524 ], [ -105.637673215706002, 22.15137934874042 ], [ -105.639083230534993, 22.151474830505322 ], [ -105.63914638655416, 22.149954974529123 ], [ -105.640628481671285, 22.149887729542513 ], [ -105.640633657683622, 22.15101000238019 ], [ -105.640971145544199, 22.151053575530625 ], [ -105.641138396650433, 22.155990897567506 ], [ -105.640155088496385, 22.156095760210007 ], [ -105.640208638237766, 22.157814175935812 ], [ -105.640803520309248, 22.157854479868945 ], [ -105.641204613770014, 22.158875550458788 ], [ -105.641211244724218, 22.160317348222861 ], [ -105.641997475866788, 22.160504510324813 ], [ -105.64273131707273, 22.174325225092673 ], [ -105.644200021613131, 22.174265222753377 ], [ -105.641507190823575, 22.178095766093179 ], [ -105.638435648625943, 22.180256196032644 ], [ -105.639059419665102, 22.193976782729465 ], [ -105.638631424608889, 22.194556814968792 ], [ -105.638898174894678, 22.196224609932756 ], [ -105.640209585405955, 22.201282984600198 ], [ -105.640611655993382, 22.2029830358303 ], [ -105.640334331949646, 22.203162727661095 ], [ -105.642034664716959, 22.219832026924166 ], [ -105.630391034120521, 22.222290966826165 ], [ -105.633583632762964, 22.239674815658589 ], [ -105.631940590931492, 22.239832527390831 ], [ -105.633248939055022, 22.254073353102342 ], [ -105.635608427411796, 22.253821492250552 ], [ -105.638968349701088, 22.253198710704226 ], [ -105.639176947999431, 22.254234076917442 ], [ -105.639463201890635, 22.255400399415919 ], [ -105.638194859374721, 22.255615603637978 ], [ -105.638720080002486, 22.262479287690212 ], [ -105.640078189079077, 22.269035242130201 ], [ -105.638743588766602, 22.270139917243341 ], [ -105.639646350771386, 22.272873805957488 ], [ -105.63974466268121, 22.276883820023215 ], [ -105.639655547861594, 22.277223302083598 ], [ -105.640665722576387, 22.285047152172638 ], [ -105.641373657555562, 22.28987728255629 ], [ -105.641627830983907, 22.292224082541395 ], [ -105.639628797369994, 22.29221182754975 ], [ -105.640106289330618, 22.299282806443671 ], [ -105.64803549873659, 22.299405359366688 ], [ -105.648395149208852, 22.303815768883737 ], [ -105.647704228680198, 22.303883662621502 ], [ -105.647971557044286, 22.306021802768043 ], [ -105.648697728873799, 22.313289039848428 ], [ -105.648919068862881, 22.314733111444411 ], [ -105.647492932117643, 22.31473998613103 ], [ -105.645454958833739, 22.314838086888585 ], [ -105.646172470772399, 22.320893750363439 ], [ -105.646027261641393, 22.322991886992497 ], [ -105.646192224506706, 22.324909827495048 ], [ -105.64640672124608, 22.326998127818115 ], [ -105.64693815907026, 22.331780935592519 ], [ -105.64665818601253, 22.3318385140646 ], [ -105.646132619216928, 22.336086489834145 ], [ -105.646488028431065, 22.338888616324823 ], [ -105.646640227535158, 22.341211768029439 ], [ -105.647020310281619, 22.344893591892799 ], [ -105.647351878089637, 22.348390414450932 ], [ -105.647637371133783, 22.350823421871326 ], [ -105.648042103068235, 22.353921377735617 ], [ -105.648876639837169, 22.361952840014339 ], [ -105.647754730847453, 22.362008463598272 ], [ -105.647214388974191, 22.362020200298446 ], [ -105.646844359130455, 22.362443284429162 ], [ -105.646177016687261, 22.362484613761296 ], [ -105.64535018212689, 22.362375351120761 ], [ -105.644178136568144, 22.362469904642921 ], [ -105.647186245969522, 22.386647916221364 ], [ -105.655745029362549, 22.434866358971078 ], [ -105.65824116325922, 22.438846912504971 ], [ -105.659504777931943, 22.442963540477706 ], [ -105.661930442965399, 22.462404656430749 ], [ -105.666165302664126, 22.465180872093583 ], [ -105.667974193153896, 22.468078511457065 ], [ -105.669247137557534, 22.470598128284621 ], [ -105.671894181868822, 22.470623889686351 ], [ -105.672845928496486, 22.471182263742094 ], [ -105.674420060728607, 22.471384904759134 ], [ -105.674412373571897, 22.471398766295806 ], [ -105.674196801800633, 22.471851832582843 ], [ -105.67264931284501, 22.474094981162807 ], [ -105.671105779780362, 22.481562417771613 ], [ -105.674308764698083, 22.496464000338221 ], [ -105.674382418668358, 22.501523528783878 ], [ -105.674921345659868, 22.503545943497784 ], [ -105.675234871297846, 22.50720038658352 ], [ -105.677154241930054, 22.51292760414276 ], [ -105.683803195353448, 22.525297932284161 ], [ -105.683871441467204, 22.525427069319278 ], [ -105.684131679859775, 22.525646984798868 ], [ -105.68436238672507, 22.525859431555432 ], [ -105.684507795862487, 22.5263454484367 ], [ -105.684571084709091, 22.527043206299425 ], [ -105.684760700708807, 22.527430996650367 ], [ -105.684855898322496, 22.528045351933258 ], [ -105.685127950398112, 22.528798063066347 ], [ -105.685653857214902, 22.529256831379428 ], [ -105.686069160812337, 22.530558270791516 ], [ -105.686612665033635, 22.531052033525839 ], [ -105.687675862155345, 22.532626782701868 ], [ -105.687767469139203, 22.532934270713497 ], [ -105.687745004113651, 22.533288074980987 ], [ -105.687913451205986, 22.533440250950719 ], [ -105.688099913805047, 22.53364285229037 ], [ -105.688375579724493, 22.534701517055282 ], [ -105.688618950306932, 22.535370451779272 ], [ -105.6890750915137, 22.536485648517555 ], [ -105.689408831947901, 22.536958079782892 ], [ -105.689710730130457, 22.537374966663663 ], [ -105.689986377480921, 22.53804403643818 ], [ -105.69041154469619, 22.53885210982628 ], [ -105.690834833460315, 22.539380518749795 ], [ -105.691166881051345, 22.539826651072531 ], [ -105.691732085573904, 22.540536925614504 ], [ -105.691825903459744, 22.542087609359612 ], [ -105.692643928236123, 22.543735397243211 ], [ -105.693038694280233, 22.545173537143853 ], [ -105.693825121822954, 22.546315330969776 ], [ -105.695068421460405, 22.548207212614727 ], [ -105.696156497346351, 22.549542475778196 ], [ -105.697006875175475, 22.550767182029972 ], [ -105.697281723851916, 22.55168690970288 ], [ -105.697857471074769, 22.552633031168455 ], [ -105.69855348333266, 22.553578993985525 ], [ -105.699130444468608, 22.55463860086013 ], [ -105.699494817588175, 22.55561248577402 ], [ -105.700133692559405, 22.557034773558257 ], [ -105.700442062864909, 22.558455900334536 ], [ -105.700535415416539, 22.560407999528081 ], [ -105.700481466795679, 22.561915004300999 ], [ -105.700072115236196, 22.563898224647517 ], [ -105.699302901260637, 22.566479456694083 ], [ -105.698828374365064, 22.567877571146425 ], [ -105.69856170887897, 22.568380717695732 ], [ -105.697839132933211, 22.568523350561577 ], [ -105.696845971701805, 22.568499910816172 ], [ -105.695672155881368, 22.568309148834146 ], [ -105.694800527789084, 22.567978556701235 ], [ -105.693986075591511, 22.567981698883386 ], [ -105.693356602471283, 22.568096654900557 ], [ -105.692605822507744, 22.568350732071622 ], [ -105.691885417119067, 22.568466040543512 ], [ -105.691131770427887, 22.568440469108396 ], [ -105.690049833689386, 22.568389139171302 ], [ -105.68924109459499, 22.56895153931697 ], [ -105.688671826243251, 22.569651701498174 ], [ -105.688524413466268, 22.570154705156313 ], [ -105.688587360730708, 22.570768018091997 ], [ -105.68822934864977, 22.571328725367835 ], [ -105.68748217398479, 22.571890553448043 ], [ -105.686307814756901, 22.572033931488363 ], [ -105.685254484588086, 22.571886528667392 ], [ -105.684903582859363, 22.571821343881822 ], [ -105.684536945524997, 22.571752901233822 ], [ -105.683773142384609, 22.571891002530606 ], [ -105.683115627150698, 22.571982973436889 ], [ -105.682659540973361, 22.572003842342042 ], [ -105.682200251396239, 22.572121049991495 ], [ -105.681745469383941, 22.572189108776456 ], [ -105.68131186590324, 22.572421944178927 ], [ -105.680955884800312, 22.57256211297198 ], [ -105.680676856249761, 22.572797618298125 ], [ -105.680244553177999, 22.573077643326883 ], [ -105.680244523044962, 22.573077683605788 ] ] ] ] } },
{ "type": "Feature", "properties": { "NUM_ANP": null, "ID_ANP": null, "ID_DOF": null, "NOMBRE": "Reserva de la Biosfera Alto Golfo de California y Delta\ndel Río Colorado", "CAT_MANEJO": null, "ESTADOS": null, "REGION": null, "SUPERFICIE": null, "S_TERRES": null, "S_MARINA": null, "PRIM_DEC": null, "ULT_DOF": null, "PM": null, "CERT_SINAP": null, "ID_restauc": 1, "Año": 2025 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -115.21172537935189, 32.358008856674481 ], [ -115.263058853280697, 32.289564224769407 ], [ -115.268762572606121, 32.223971452527046 ], [ -115.234540256653588, 32.138415662645706 ], [ -115.183206782724781, 32.084230329054193 ], [ -115.12616958947055, 32.030044995462674 ], [ -115.063428676890908, 31.975859661871159 ], [ -115.003539623973964, 31.924526187942355 ], [ -114.955058009707869, 31.91311874929151 ], [ -114.935094992068898, 31.947341065244046 ], [ -114.929391272743473, 31.99867453917285 ], [ -114.912280114767199, 32.035748714788099 ], [ -114.880909658477378, 32.044304293776229 ], [ -114.8096131669096, 32.030044995462674 ], [ -114.781094570282477, 31.97300780220845 ], [ -114.738316675341807, 31.935933626593201 ], [ -114.686983201413, 31.893155731652531 ], [ -114.655612745123179, 31.838970398061015 ], [ -114.647057166135042, 31.793340643457633 ], [ -114.706946219051986, 31.787636924132212 ], [ -114.758279692980793, 31.836118538398303 ], [ -114.838131763536708, 31.898859450977952 ], [ -114.872354079489241, 31.918822468616934 ], [ -114.94365057105702, 31.887452012327106 ], [ -115.014947062624813, 31.878896433338973 ], [ -115.140428887784111, 31.947341065244046 ], [ -115.223132818002739, 32.01578569714912 ], [ -115.308688607884079, 32.075674750066057 ], [ -115.337207204511188, 32.121304504669439 ], [ -115.331503485185763, 32.19545285589993 ], [ -115.328651625523065, 32.261045628142291 ], [ -115.322947906197641, 32.318082821396523 ], [ -115.29728116923323, 32.355156997011768 ], [ -115.25450327429256, 32.36656443566261 ], [ -115.21172537935189, 32.358008856674481 ] ] ] ] } },
{ "type": "Feature", "properties": { "NUM_ANP": null, "ID_ANP": null, "ID_DOF": null, "NOMBRE": "Teacapan-Agua Brava-Marismas Nacionales", "CAT_MANEJO": null, "ESTADOS": null, "REGION": null, "SUPERFICIE": null, "S_TERRES": null, "S_MARINA": null, "PRIM_DEC": null, "ULT_DOF": null, "PM": null, "CERT_SINAP": null, "ID_restauc": null, "Año": 2050 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ -105.675063197546947, 22.577889001567232 ], [ -105.680366564470447, 22.572965245871018 ], [ -105.682163333592044, 22.572162442937486 ], [ -105.683960102713641, 22.571841320454801 ], [ -105.685698911541024, 22.571787799968288 ], [ -105.687669561545363, 22.571734279460991 ], [ -105.688249164487786, 22.571306114654487 ], [ -105.688712846841781, 22.570289217908662 ], [ -105.689640211549701, 22.568415967423693 ], [ -105.692132504202249, 22.568362445607239 ], [ -105.694508876266312, 22.56782722629978 ], [ -105.696363605682166, 22.568415967423693 ], [ -105.698566096863473, 22.568469489219378 ], [ -105.707897704236984, 22.572965245871018 ], [ -105.721576333678911, 22.587093812006859 ], [ -105.727140521926444, 22.597368222654445 ], [ -105.751252004332528, 22.61791474335622 ], [ -105.771654027906891, 22.640170010453456 ], [ -105.795765510312947, 22.647017059824936 ], [ -105.805039157392187, 22.660710134364276 ], [ -105.819876992719017, 22.676113210221057 ], [ -105.823586451550725, 22.68809218436844 ], [ -105.823586451550725, 22.705203188349177 ], [ -105.823586451550725, 22.718890452324814 ], [ -105.808748616223895, 22.749681790308088 ], [ -105.788346592649546, 22.768495304419375 ], [ -105.749397274916674, 22.775335939608414 ], [ -105.716012145431336, 22.775335939608414 ], [ -105.693755392441119, 22.771915664869418 ], [ -105.662224992371662, 22.763364603058076 ], [ -105.645532427628993, 22.751392216855056 ], [ -105.612147298143697, 22.732576347416753 ], [ -105.610292568727814, 22.689803380934972 ], [ -105.595454733401013, 22.653863767822127 ], [ -105.582471627490079, 22.619626814901032 ], [ -105.569488521579103, 22.5819563192284 ], [ -105.549086498004741, 22.549414417209078 ], [ -105.549086498004741, 22.528857681366087 ], [ -105.569488521579061, 22.516864838951271 ], [ -105.569778323050272, 22.515713685489921 ], [ -105.571575092171884, 22.515124719546392 ], [ -105.572473476732696, 22.515472745179999 ], [ -105.573661662764735, 22.514428665650307 ], [ -105.576356816447145, 22.514428665650307 ], [ -105.578008684833136, 22.513304263490898 ], [ -105.576211915711497, 22.509556190240058 ], [ -105.576762538506841, 22.508458520980181 ], [ -105.583601853227805, 22.509154604936363 ], [ -105.58389165469903, 22.506236383363149 ], [ -105.585224741466661, 22.506370248085837 ], [ -105.58710845102965, 22.509877457643185 ], [ -105.588122756178905, 22.50993100213779 ], [ -105.588528478238644, 22.51081448330492 ], [ -105.5893689025052, 22.510680622884923 ], [ -105.59020932677177, 22.511885361998868 ], [ -105.590093406183257, 22.513839694231304 ], [ -105.590759949567072, 22.513705836740641 ], [ -105.591310572362417, 22.514321580124424 ], [ -105.59246977824732, 22.513759379752472 ], [ -105.594672269428656, 22.521362276842719 ], [ -105.600613199588821, 22.51748056826229 ], [ -105.600207477529096, 22.516677442529531 ], [ -105.600526259147443, 22.515633372099959 ], [ -105.600960961354275, 22.514964092035328 ], [ -105.602670790034523, 22.51440189427662 ], [ -105.603540194448186, 22.514883778209793 ], [ -105.604003876802167, 22.514937320765338 ], [ -105.604061837096395, 22.515178262008597 ], [ -105.606872911367304, 22.513518436035945 ], [ -105.607133732691409, 22.512902689074579 ], [ -105.60782925622236, 22.512581428701584 ], [ -105.6087856010774, 22.512768830676563 ], [ -105.611683615789659, 22.511537327333215 ], [ -105.611741576083915, 22.510868027436622 ], [ -105.611654635642566, 22.509984546611665 ], [ -105.612205258437868, 22.509690051748759 ], [ -105.613480384911284, 22.51073416706847 ], [ -105.615103273150154, 22.511135747784092 ], [ -105.615653895945471, 22.512179852185447 ], [ -105.617769446685443, 22.513170405481752 ], [ -105.618262109186517, 22.513009775699665 ], [ -105.617798426832522, 22.513866465713889 ], [ -105.618262109186517, 22.515151490780088 ], [ -105.62034867977934, 22.515151490780088 ], [ -105.621276044487246, 22.514080637387856 ], [ -105.624289979788017, 22.511510555399564 ], [ -105.628926803327644, 22.509582962552173 ], [ -105.631477056274449, 22.510011318840824 ], [ -105.637504926875962, 22.513866465713889 ], [ -105.638895973937835, 22.518792330255685 ], [ -105.637968609229929, 22.52114811645265 ], [ -105.638432291583896, 22.52307554801385 ], [ -105.640982544530701, 22.523932175632869 ], [ -105.64469200336238, 22.523932175632869 ], [ -105.645155685716361, 22.522647232212677 ], [ -105.643996479831458, 22.520291471573195 ], [ -105.644228321008413, 22.518792330255685 ], [ -105.646083050424281, 22.518792330255685 ], [ -105.651647238671814, 22.519434821383172 ], [ -105.658138791627294, 22.518149836141163 ], [ -105.659529838689181, 22.522218915083748 ], [ -105.664398503405792, 22.526930330472378 ], [ -105.672049262246219, 22.538279898578566 ], [ -105.672049262246219, 22.542348384523379 ], [ -105.669962691653382, 22.552840242215215 ], [ -105.674135832839042, 22.56161853049224 ], [ -105.674367674015997, 22.565900419588434 ], [ -105.675063197546947, 22.577889001567232 ] ] ] ] }
]};

    document.addEventListener('DOMContentLoaded', (event) => {
        processData(myStaticGeoJSON1, "En proceso de atención puntos");
        processData(myStaticGeoJSON2, "En proceso de atención polígonos");
    });
</script>

</body>
</html>

